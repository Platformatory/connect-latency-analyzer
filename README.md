# Connect Latency Analyzer

Connect Latency Analyzer processes the data generated by `connect-timestamp-interceptors` to calculate the End-to-End Latency of the complete Connect pipeline. The Analyzer contains two parts,

1. **KSQL Latency Analyzer**
    - Process the timestamps from the telemtry topics and calculate the end to end latency
    - Out the calculated latencies into an output topic called `final_latency_data`
2. **Kafka Prom Push**
    - Reads the calculated latency data from the `final_latency_data` topic
    - Push it into a configurable Prometheus instance as datasource

## Pre-requisites

- Confluent Cloud Account
- Kafka Api Key and Secret
- Prometheus Instance

## Setup

```sh
# Clone using SSH
git clone git@github.com:Platformatory/connect-latency-analyzer.git
```

### Environment variables

```bash
export BOOTSTRAP_SERVERS=
export KAFKA_SASL_JAAS_CONFIG=
export KAFKA_VALUE_CONVERTER_SCHEMA_REGISTRY_URL=
export KAFKA_VALUE_CONVERTER_SCHEMA_REGISTRY_BASIC_AUTH_USER_INFO=

# For the KSQL service (comma-separated list of input topics)
export TELEMETRY_TOPIC=connect_latency_telemetry

# COnfigure the Prometheus push gateway endpoint
export PROMETHEUS_ENDPOINT="prom-pushgateway:9091"
```

## Start the Latency Analyzer

```bash
docker-compose up -d
```



